<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>OMNI</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<style>
:root{
  --bg:#fff;
  --fg:#0b0b0d;
  --muted:rgba(11,11,13,.55);
  --line:rgba(11,11,13,.18);
}
@media (prefers-color-scheme: dark){
  :root{
    --bg:#000;
    --fg:#fff;
    --muted:rgba(255,255,255,.55);
    --line:rgba(255,255,255,.18);
  }
}

*{ box-sizing:border-box }
html,body{ height:100%; margin:0 }

body{
  background:var(--bg);
  color:var(--fg);
  font-family:system-ui,-apple-system,BlinkMacSystemFont,
    "Segoe UI",Roboto,Helvetica,Arial,sans-serif;
  display:grid;
  place-items:center;
}

.center{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:18px;
}

/* Logo */
.logo{
  width:clamp(300px,60vw,460px);
}

/* Search */
.search-wrap{ width:260px }

.search-input{
  width:100%;
  padding:10px 14px;
  border-radius:999px;
  border:1px solid var(--line);
  background:transparent;
  color:var(--fg);
  text-align:center;
  outline:none;
}

/* Results */
.results{
  font-size:11px;
  letter-spacing:.06em;
  color:var(--muted);
  min-height:18px;
  transition:color .2s ease;
}
.results.active{ color:var(--fg) }
</style>
</head>

<body>

<div class="center">

  <!-- OMNI LOGO -->
  <svg class="logo" xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 460 150" role="img" aria-label="OMNI logo">
    <defs>
      <linearGradient id="auroraHue"
        x1="-120%" y1="0%" x2="120%" y2="0%"
        gradientUnits="userSpaceOnUse">
        <stop offset="0%" stop-color="#00f5ff"/>
        <stop offset="28%" stop-color="#7cff00"/>
        <stop offset="58%" stop-color="#ff00e5"/>
        <stop offset="82%" stop-color="#ffaa00"/>
        <stop offset="100%" stop-color="#00f5ff"/>
        <animate attributeName="x1" from="-120%" to="0%" dur="26s" repeatCount="indefinite"/>
        <animate attributeName="x2" from="120%" to="240%" dur="26s" repeatCount="indefinite"/>
      </linearGradient>

      <filter id="outerGlow" x="-60%" y="-60%" width="220%" height="220%">
        <feGaussianBlur stdDeviation="6"/>
        <feColorMatrix type="matrix"
          values="1 0 0 0 0
                  0 1 0 0 0
                  0 0 1 0 0
                  0 0 0 .85 0"/>
      </filter>

      <filter id="innerGlow">
        <feGaussianBlur stdDeviation="2"/>
      </filter>
    </defs>

    <g fill="none" stroke="url(#auroraHue)" stroke-width="4"
      stroke-linecap="round" stroke-linejoin="round"
      filter="url(#outerGlow)">
      <animate attributeName="opacity"
        values="0.58;0.66;0.58"
        dur="22s" repeatCount="indefinite"/>
      <path d="M70 22 C44 22 22 44 22 75 C22 106 44 128 70 128 C96 128 118 106 118 75 C118 44 96 22 70 22 Z"/>
      <path d="M132 124 V38 Q132 26 144 26 H148 L184 92 L220 26 H224 Q236 26 236 38 V124"/>
      <path d="M246 124 V38 Q246 26 258 26 H262 L318 114 Q322 124 332 124 V38 Q332 26 320 26"/>
      <rect x="350" y="26" width="30" height="98" rx="15"/>
    </g>

    <g fill="currentColor">
      <path d="M70 22 C44 22 22 44 22 75 C22 106 44 128 70 128 C96 128 118 106 118 75 C118 44 96 22 70 22 Z"/>
      <circle cx="70" cy="75" r="22" opacity="0.9" filter="url(#innerGlow)"/>
      <circle cx="70" cy="75" r="34" fill="none"
        stroke="currentColor" stroke-width="1" opacity="0.055">
        <animateTransform type="rotate"
          from="0 70 75" to="360 70 75"
          dur="90s" repeatCount="indefinite"/>
      </circle>
      <path d="M132 124 V38 Q132 26 144 26 H148 L184 92 L220 26 H224 Q236 26 236 38 V124"/>
      <path d="M246 124 V38 Q246 26 258 26 H262 L318 114 Q322 124 332 124 V38 Q332 26 320 26"/>
      <rect x="350" y="26" width="30" height="98" rx="15"/>
    </g>

    <text x="392" y="44" font-size="14"
      opacity="0.45"
      font-family="system-ui,-apple-system,BlinkMacSystemFont,Arial,sans-serif">™</text>
  </svg>

  <!-- SEARCH -->
  <div class="search-wrap">
    <input id="searchInput" class="search-input"
      type="search" placeholder="SEARCH OMNI"/>
  </div>

  <!-- RESULTS -->
  <div class="results" id="results">OMNI IDLE</div>

</div>

<script>
/* ─────────────────────────────
   OMNI BRAIN v5 — Single-Page Core
───────────────────────────── */

const HALF_LIFE = 1000 * 60 * 60 * 6;

const DEFAULT = {
  meta:{ version:5, created:Date.now(), searches:0 },
  state:{ attention:.5, confidence:.5, last:null },
  concepts:{} // label → { weight,count,lastSeen,links:{} }
};

/* Persistence */
const load = () => {
  try{
    const b = JSON.parse(localStorage.getItem("omni_brain"));
    if(b?.meta?.version >= 4) return b;
  }catch{}
  return structuredClone(DEFAULT);
};
const save = b =>
  localStorage.setItem("omni_brain", JSON.stringify(b));

/* Utils */
const normalize = t =>
  t.toLowerCase().trim().replace(/[^\w\s]/g,"").replace(/\s+/g," ");

/* Brain ops */
function decay(brain){
  const now = Date.now();
  for(const k in brain.concepts){
    const c = brain.concepts[k];
    c.weight *= Math.exp(-(now - c.lastSeen) / HALF_LIFE);
    if(c.weight < .05) delete brain.concepts[k];
  }
}

function reinforce(brain,label){
  const now = Date.now();
  const c = brain.concepts[label] ||= {
    label, weight:.25, count:0, lastSeen:now, links:{}
  };

  c.count++;
  c.weight = Math.min(1, c.weight + .2 * (1 - c.weight));
  c.lastSeen = now;

  if(brain.state.last && brain.state.last !== label){
    const p = brain.concepts[brain.state.last];
    p.links[label] = (p.links[label]||0) + .15;
    c.links[brain.state.last] = (c.links[brain.state.last]||0) + .15;
  }
  brain.state.last = label;
}

function infer(brain){
  return Object.values(brain.concepts)
    .sort((a,b)=>{
      const sa = a.weight + Object.values(a.links).reduce((s,v)=>s+v,0);
      const sb = b.weight + Object.values(b.links).reduce((s,v)=>s+v,0);
      return sb - sa;
    })
    .slice(0,3)
    .map(c=>c.label.toUpperCase());
}

/* UI */
const brain = load();
decay(brain);

const input = document.getElementById("searchInput");
const results = document.getElementById("results");

/* Typing = intent */
input.addEventListener("input",e=>{
  const v = normalize(e.target.value);
  if(!v){
    results.textContent = "OMNI IDLE";
    results.classList.remove("active");
    return;
  }
  results.textContent = `INTENT · ${v.toUpperCase()}`;
  results.classList.add("active");
});

/* Enter = commit */
input.addEventListener("keydown",e=>{
  if(e.key !== "Enter") return;
  e.preventDefault();

  const intent = normalize(input.value);
  if(!intent) return;

  brain.meta.searches++;
  reinforce(brain,intent);
  save(brain);

  const top = infer(brain);
  results.textContent = `ACTIVE · ${top.join(" · ")}`;
  results.classList.add("active");
});
</script>

</body>
</html>
