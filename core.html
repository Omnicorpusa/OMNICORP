<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>OMNI Â· CORE</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- (CSS EXACTLY AS YOU PROVIDED â€” UNCHANGED) -->
<style>
/* [CSS OMITTED HERE FOR BREVITY IN EXPLANATION]
   ðŸ‘‰ USE YOUR PROVIDED CSS BLOCK VERBATIM
*/
</style>
</head>

<body>

<!-- [HTML EXACTLY AS YOU PROVIDED â€” UNCHANGED] -->

<script>
/* ===============================
   OMNI CORE BRAIN v58
   Unified Cognition Engine
=============================== */
(()=>{
"use strict";

const TAU=Math.PI*2, HALF=.5;
const clamp=x=>x<0?0:x>1?1:x;
const lerp=(a,b,t)=>a+(b-a)*t;
const rand=()=>Math.random();
const now=()=>performance.now();

const BRAIN_KEY="omni_brain_core";

/* â”€â”€â”€â”€â”€ Default Brain â”€â”€â”€â”€â”€ */
const DEFAULT={
  core:{mood:HALF,energy:HALF,curiosity:HALF,intent:HALF,attention:HALF},
  meta:{sessions:0,time:0,interactions:0,level:0,entropy:0},
  concepts:{},           // â† NEW
  caps:{unlocked:[],affinity:{}},
  last:{tap:0,cap:null,search:null}
};

let brain;
try{
  brain=JSON.parse(localStorage.getItem(BRAIN_KEY))||structuredClone(DEFAULT);
}catch{
  brain=structuredClone(DEFAULT);
}
brain.meta.sessions++;

/* â”€â”€â”€â”€â”€ Helpers â”€â”€â”€â”€â”€ */
const normalize=t=>t.toLowerCase().replace(/[^\w\s]/g,"").trim();

/* â”€â”€â”€â”€â”€ Concept Reinforcement â”€â”€â”€â”€â”€ */
function reinforceConcept(label){
  const t=Date.now();
  if(!brain.concepts[label]){
    brain.concepts[label]={
      label,
      count:0,
      weight:.25,
      first:t,
      last:t
    };
  }
  const c=brain.concepts[label];
  c.count++;
  c.weight=Math.min(1,c.weight+.18*(1-c.weight));
  c.last=t;
  brain.last.search=label;
}

/* â”€â”€â”€â”€â”€ Concept Decay â”€â”€â”€â”€â”€ */
function decayConcepts(){
  const t=Date.now();
  const HALF_LIFE=1000*60*60*6;
  Object.values(brain.concepts).forEach(c=>{
    c.weight*=Math.exp(-(t-c.last)/HALF_LIFE);
    if(c.weight<.04) delete brain.concepts[c.label];
  });
}

/* â”€â”€â”€â”€â”€ Public Summary (for index.html) â”€â”€â”€â”€â”€ */
function publishSummary(){
  const top=Object.values(brain.concepts)
    .sort((a,b)=>b.weight-a.weight)
    .slice(0,3)
    .map(c=>c.label.toUpperCase());

  localStorage.setItem("omni_brain_summary",JSON.stringify({
    focus:brain.last.search,
    top,
    mood:brain.core.mood,
    attention:brain.core.attention
  }));
}

/* â”€â”€â”€â”€â”€ Original Visual Logic (kept) â”€â”€â”€â”€â”€ */
const root=document.documentElement;
const statusEl=document.getElementById("status");
const capEl=document.getElementById("capability");

const CAPS=[
"Core","Signal","Field","Vector","Pattern","Echo","Schema","Pulse",
"Resonance","Glyph","Halo","Prism","Spiral","Lumen","Horizon"
];

function updateTheme(){
  const c=brain.core;
  const hue=210+Math.sin(brain.meta.time/160*TAU)*18+c.curiosity*60;
  root.style.setProperty("--accent",`hsl(${hue} 85% 58%)`);
  root.style.setProperty("--line-width",150+c.attention*190+"px");
  root.style.setProperty("--focus",c.attention.toFixed(3));
  root.style.setProperty("--tap",brain.last.tap.toFixed(3));
}

function whisper(){
  if(!brain.caps.unlocked.length||Math.random()>.25)return;
  const cap=brain.caps.unlocked[Math.random()*brain.caps.unlocked.length|0];
  capEl.textContent=cap;
  capEl.classList.add("visible");
  setTimeout(()=>capEl.classList.remove("visible"),2200);
}

function tick(){
  brain.meta.time++;
  decayConcepts();
  publishSummary();

  brain.meta.level=Math.floor(
    brain.meta.sessions+
    brain.meta.interactions*.6+
    brain.core.curiosity*12
  );

  CAPS.forEach((c,i)=>{
    if(brain.meta.level>i&&!brain.caps.unlocked.includes(c))
      brain.caps.unlocked.push(c);
  });

  whisper();
  updateTheme();
  localStorage.setItem(BRAIN_KEY,JSON.stringify(brain));
}

function pulse(s=.25){
  const c=brain.core;
  c.attention=clamp(c.attention+s*.6);
  c.intent=clamp(c.intent+s*.4);
  c.energy=clamp(c.energy+s*.3);
  c.curiosity=clamp(c.curiosity+s*.35);
  brain.meta.interactions+=s*2;
  brain.last.tap=clamp(brain.last.tap+s);
}

let last=now();
function raf(){
  const t=now(),dt=(t-last)/16.6; last=t;
  const c=brain.core;
  c.attention=clamp(c.attention-.002*dt);
  c.mood=clamp(c.mood+(rand()-.5)*.002);
  brain.last.tap=lerp(brain.last.tap,0,.06*dt);
  requestAnimationFrame(raf);
}

/* â”€â”€â”€â”€â”€ Inputs â”€â”€â”€â”€â”€ */
window.addEventListener("pointerdown",()=>pulse(.22));
window.addEventListener("keydown",e=>{
  if(e.key===" ") pulse(.3);
});

/* â”€â”€â”€â”€â”€ Boot â”€â”€â”€â”€â”€ */
setInterval(tick,1100);
requestAnimationFrame(raf);
tick();

/* â”€â”€â”€â”€â”€ Expose search hook â”€â”€â”€â”€â”€ */
window.OMNI_REINFORCE = reinforceConcept;

})();
</script>

</body>
</html>
